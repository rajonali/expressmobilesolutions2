{"version":3,"sources":["webpack:///./src/components/StripeCartProviderParent.js","webpack:///./src/pages/cart_example.js"],"names":["StripeCartProviderParent","stripePromise","loadStripe","mode","stripe","successUrl","isBrowser","window","location","origin","cancelUrl","currency","allowedCountries","billingAddressCollection","CartOverview","Moltin","require","CartExample","useState","setLoading","setItems","setMeta","setCartId","useContext","CartContext","updateCartCount","a","localStorage","getItem","cartIdLocal","console","log","getCartItems","then","data","meta","useEffect","Layout","SEO","title","style","paddingTop"],"mappings":"6TAKaA,EAA2B,WAEpC,IAAMC,EAAgBC,YAAW,+GAIjC,OAEI,kBAAC,IAAD,CACIC,KAAK,cACLC,OAAQH,EACRI,WAAYC,WAAgBC,OAAOC,SAASC,OAAvB,WACrBC,UAAWJ,WAAgBC,OAAOC,SAASC,OAAvB,IACpBE,SAAS,MACTC,iBAAkB,CAAC,KAAM,KAAM,MAC/BC,0BAA0B,GAE1B,kBAACC,aAAD,QCdNC,EAASC,EAAQ,QAYDd,YAAW,+GA+FlBe,UA7FK,SAAC,GAAkB,IAAhBT,EAAe,EAAfA,SAAe,EAEJU,oBAAS,GAAvBC,GAFkB,aAGRD,mBAAS,IAArBE,GAHoB,aAIAF,oBAAS,GAJT,aAKVA,mBAAS,KAApBG,GALqB,aAMNH,mBAAS,IAAtBI,GANmB,WAONC,qBAAWC,KAA/BC,gBAP0B,4CAalC,4BAAAC,EAAA,sEAC8BC,aAAaC,QAAQ,SADnD,cACUC,EADV,OAEIC,QAAQC,IAAIF,GAFhB,SAGUd,EAAOiB,aAAaH,GAAaI,MAAK,YAAqB,IAAlBC,EAAiB,EAAjBA,KAAMC,EAAW,EAAXA,KACjDL,QAAQC,IAAIG,GACZd,EAASc,GACTZ,EAAUO,GACVR,EAAQc,GACRhB,GAAW,MARnB,4CAbkC,sBAyBlCiB,qBAAU,YAzBwB,mCA0B9BJ,KACD,IA0DH,OAAQ,kBAACK,EAAA,EAAD,CAAQ7B,SAAUA,GACtB,kBAAC8B,EAAA,EAAD,CAAKC,MAAM,iBACX,wBAAIC,MAAO,CAAEC,WAAY,SAAzB,iBACL,kBAAC,EAAD","file":"component---src-pages-cart-example-js-8f78757cac7dcf8d1454.js","sourcesContent":["\nimport { loadStripe } from '@stripe/stripe-js'\nimport { CartProvider } from 'use-shopping-cart'\nimport React, { useState, useContext, useEffect, componentDidMount } from 'react'\n\nexport const StripeCartProviderParent = () => {\n    \n    const stripePromise = loadStripe(\"pk_test_51IGhToG3l6YaloTgAakGvMYVjrveEMs7oFJF7akytn6gyne2Lq0GDYmAYxh0iqFMPIclDMwQ1PtGqhq26WvwHYGw001BbrEVn0\")\n\n\n\n    return (\n\n        <CartProvider\n            mode=\"client-only\"\n            stripe={stripePromise}\n            successUrl={isBrowser && `${window.location.origin}/page-2/`}\n            cancelUrl={isBrowser && `${window.location.origin}/`}\n            currency=\"USD\"\n            allowedCountries={['US', 'GB', 'CA']}\n            billingAddressCollection={true}\n        >\n            <CartOverview />\n        </CartProvider>\n\n\n    )\n}\n\n\n","import React, { useState, useContext, useEffect, componentDidMount } from 'react'\nimport CartItemList from '../components/CartItemList'\nimport CartSummary from '../components/CartSummary'\nimport CartContext from '../components/Context/CartContext'\n\n\nimport { Location } from '@reach/router';\n\nconst Moltin = require('../../lib/moltin')\n\nimport Layout from '../components/Layout'\nimport SEO from '../components/SEO'\n\nimport Skus from '../components/Products/Skus'\nimport CartOverview from '../components/CartOverview'\n\nimport { loadStripe } from '@stripe/stripe-js'\nimport { CartProvider } from 'use-shopping-cart'\nimport { StripeCartProviderParent } from '../components/StripeCartProviderParent';\n\nconst stripePromise = loadStripe(\"pk_test_51IGhToG3l6YaloTgAakGvMYVjrveEMs7oFJF7akytn6gyne2Lq0GDYmAYxh0iqFMPIclDMwQ1PtGqhq26WvwHYGw001BbrEVn0\")\n\nconst CartExample = ({ location }) => {\n\n    const [loading, setLoading] = useState(true)\n    const [items, setItems] = useState([])\n    const [completed, setCompleted] = useState(false)\n    const [meta, setMeta] = useState({})\n    const [cartId, setCartId] = useState({})\n    const { updateCartCount } = useContext(CartContext)\n\n\n\n\n\n    async function getCartItems() {\n        const cartIdLocal = await localStorage.getItem('mcart')\n        console.log(cartIdLocal)\n        await Moltin.getCartItems(cartIdLocal).then(({ data, meta }) => {\n            console.log(data)\n            setItems(data)\n            setCartId(cartIdLocal)\n            setMeta(meta)\n            setLoading(false)\n        })\n    }\n\n    useEffect(() => {\n        getCartItems()\n    }, [])\n\n    const handleCheckout = async data => {\n        const cartId = await localStorage.getItem('mcart')\n        const customerId = localStorage.getItem('mcustomer')\n\n        const {\n            id: token,\n            email,\n            card: {\n                name,\n                address_line1: line_1,\n                address_city: city,\n                address_country: country,\n                address_state: county,\n                address_zip: postcode,\n            },\n        } = data\n\n        const customer = customerId || { name, email }\n\n        const address = {\n            first_name: name.split(' ')[0],\n            last_name: name.split(' ')[1] || '',\n            line_1,\n            city,\n            county: county || '',\n            country,\n            postcode,\n        }\n\n        try {\n            const {\n                data: { id },\n            } = await Moltin.checkoutCart(cartId, customer, address)\n            await Moltin.payForOrder(id, token, email)\n            setCompleted(true)\n            updateCartCount(0, cartId)\n        } catch (e) {\n            console.log(e)\n        }\n    }\n\n    const handleRemoveFromCart = itemId => {\n        Moltin.removeFromCart(itemId, cartId).then(({ data, meta }) => {\n            const total = data.reduce((a, c) => a + c.quantity, 0)\n            updateCartCount(total, cartId)\n            setItems(data)\n            setMeta(meta)\n        })\n    }\n\n    const rest = { completed, items, loading, cartId }\n\n\n    const isBrowser = () => typeof window !== \"undefined\"\n\n\n    return (<Layout location={location}>\n        <SEO title=\"Cart Example\" />\n        <h1 style={{ paddingTop: '60px' }}>Cart Overview</h1>\n   <StripeCartProviderParent />\n    </Layout>\n    )\n}\n\nexport default CartExample\n"],"sourceRoot":""}